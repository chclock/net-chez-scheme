<!DOCTYPE HTML>
<html>

<head>
  <meta charset="utf-8">
  <title>WebSocket test</title>

  <script type="text/javascript">
    function WebSocketTest() {
      if ("WebSocket" in window) {
        ShowInfo("your brower support WebSocket!");

        // 打开一个 web socket
        var ws = new WebSocket("ws://127.0.0.1:8124");

        ws.onopen = function () {
          // Web Socket 已连接上，使用 send() 方法发送数据
          ws.send("send data");
          ShowInfo("data sending...");
        };

        ws.onmessage = function (evt) {
          var received_msg = evt.data;
          ShowInfo("data received: " + received_msg);
        };

        ws.onclose = function () {
          // 关闭 websocket
          ShowInfo("websocket close...");
        };
      } else {
        // 浏览器不支持 WebSocket
        ShowInfo("your brower don't support WebSocket!");
      }
    }

    function ShowInfo(text) {
      document.getElementById("msg").innerHTML += text + "<br/>";
    }
  </script>

</head>

<body>
  <div id="sse">
    <a href="javascript:WebSocketTest()">run WebSocket</a>
  </div>
  <div id="msg"></div>
</body>

</html>